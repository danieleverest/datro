

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>jitsi-dev &mdash; Element -  WebApp 0.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="jitsi" href="jitsi.html" />
    <link rel="prev" title="feature-flags" href="feature-flags.html" /> 
<!-- google tracking code start --> 
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6BTNPTMXBF"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-6BTNPTMXBF');
</script>
<!-- google tracking code end -->
<style>html{overflow-y:scroll;} ::-webkit-scrollbar{width:0px;background:transparent;}</style></head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Element -  WebApp
          

          
            
            <img src="_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version"> Document Version : 
                0.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search" class="placeholder-final" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="releasenotes.html">Release Notes and Notices</a></li>
<li class="toctree-l1"><a class="reference internal" href="app-load.html">app-load</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">config</a></li>
<li class="toctree-l1"><a class="reference internal" href="customisations.html">customisations</a></li>
<li class="toctree-l1"><a class="reference internal" href="e2ee.html">e2ee</a></li>
<li class="toctree-l1"><a class="reference internal" href="e2ee.html#disabling-encryption-by-default">Disabling encryption by default</a></li>
<li class="toctree-l1"><a class="reference internal" href="e2ee.html#requiring-secure-backup">Requiring secure backup</a></li>
<li class="toctree-l1"><a class="reference internal" href="e2ee.html#preferring-setup-methods">Preferring setup methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="feature-flags.html">feature-flags</a></li>
<li class="toctree-l1"><a class="reference internal" href="feature-flags.html#interaction-with-spec-process">Interaction with spec process</a></li>
<li class="toctree-l1"><a class="reference internal" href="feature-flags.html#starting-work-on-a-feature">Starting work on a feature</a></li>
<li class="toctree-l1"><a class="reference internal" href="feature-flags.html#enabling-by-default-on-develop-and-nightly">Enabling by default on develop and nightly</a></li>
<li class="toctree-l1"><a class="reference internal" href="feature-flags.html#enabling-by-default-on-staging-app-and-release">Enabling by default on staging, app, and release</a></li>
<li class="toctree-l1"><a class="reference internal" href="feature-flags.html#feature-deployed-successfully">Feature deployed successfully</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">jitsi-dev</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#jitsi-wrapper-developer-docs">Jitsi wrapper developer docs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#brief-introduction-to-widgets">Brief introduction to widgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="#brief-introduction-to-integration-managers">Brief introduction to integration managers</a></li>
<li class="toctree-l1"><a class="reference internal" href="#widgets-configured-by-integration-managers">Widgets configured by integration managers</a></li>
<li class="toctree-l1"><a class="reference internal" href="#jitsi-widgets-from-integration-managers">Jitsi widgets from integration managers</a></li>
<li class="toctree-l1"><a class="reference internal" href="#jitsi-widgets-generated-by-element-itself">Jitsi widgets generated by Element itself</a></li>
<li class="toctree-l1"><a class="reference internal" href="#the-jitsi-wrapper-in-element">The Jitsi wrapper in Element</a></li>
<li class="toctree-l1"><a class="reference internal" href="jitsi.html">jitsi</a></li>
<li class="toctree-l1"><a class="reference internal" href="jitsi.html#configuring-element-to-use-your-self-hosted-jitsi-server">Configuring Element to use your self-hosted Jitsi server</a></li>
<li class="toctree-l1"><a class="reference internal" href="jitsi.html#element-android">Element Android</a></li>
<li class="toctree-l1"><a class="reference internal" href="jitsi.html#element-ios">Element iOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="kubernetes.html">kubernetes</a></li>
<li class="toctree-l1"><a class="reference internal" href="labs.html">labs</a></li>
<li class="toctree-l1"><a class="reference internal" href="labs.html#submit-abuse-report-to-moderators-msc3215-support-feature-report-to-moderators">Submit Abuse Report to Moderators MSC3215 support (<code class="docutils literal notranslate"><span class="pre">feature_report_to_moderators</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="labs.html#matrix-spaces-msc1772-support-feature-spaces">Matrix Spaces MSC1772 support (<code class="docutils literal notranslate"><span class="pre">feature_spaces</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="labs.html#render-latex-maths-in-messages-feature-latex-maths">Render LaTeX maths in messages (<code class="docutils literal notranslate"><span class="pre">feature_latex_maths</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="labs.html#message-pinning-feature-pinning">Message pinning (<code class="docutils literal notranslate"><span class="pre">feature_pinning</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="labs.html#custom-status-feature-custom-status">Custom status (<code class="docutils literal notranslate"><span class="pre">feature_custom_status</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="labs.html#custom-tags-feature-custom-tags">Custom tags (<code class="docutils literal notranslate"><span class="pre">feature_custom_tags</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="labs.html#render-simple-counters-in-room-header-feature-state-counters">Render simple counters in room header (<code class="docutils literal notranslate"><span class="pre">feature_state_counters</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="labs.html#multiple-integration-managers-feature-many-integration-managers">Multiple integration managers (<code class="docutils literal notranslate"><span class="pre">feature_many_integration_managers</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="labs.html#new-ways-to-ignore-people-feature-mjolnir">New ways to ignore people (<code class="docutils literal notranslate"><span class="pre">feature_mjolnir</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="labs.html#verifications-in-dms-feature-dm-verification">Verifications in DMs (<code class="docutils literal notranslate"><span class="pre">feature_dm_verification</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="labs.html#bridge-info-tab-feature-bridge-state">Bridge info tab (<code class="docutils literal notranslate"><span class="pre">feature_bridge_state</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="labs.html#presence-indicator-in-room-list-feature-presence-in-room-list">Presence indicator in room list (<code class="docutils literal notranslate"><span class="pre">feature_presence_in_room_list</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="labs.html#custom-themes-feature-custom-themes">Custom themes (<code class="docutils literal notranslate"><span class="pre">feature_custom_themes</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="labs.html#message-preview-tweaks">Message preview tweaks</a></li>
<li class="toctree-l1"><a class="reference internal" href="labs.html#communities-v2-prototyping-feature-communities-v2-prototypes-in-development">Communities v2 prototyping (<code class="docutils literal notranslate"><span class="pre">feature_communities_v2_prototypes</span></code>) [In Development]</a></li>
<li class="toctree-l1"><a class="reference internal" href="labs.html#dehydrated-devices-feature-dehydration">Dehydrated devices (<code class="docutils literal notranslate"><span class="pre">feature_dehydration</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="labs.html#do-not-disturb-feature-dnd">Do not disturb (<code class="docutils literal notranslate"><span class="pre">feature_dnd</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="labs.html#hidden-read-receipts-feature-hidden-read-receipts">Hidden read receipts (<code class="docutils literal notranslate"><span class="pre">feature_hidden_read_receipts</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="memory-profiles-and-leaks.html">memory-profiles-and-leaks</a></li>
<li class="toctree-l1"><a class="reference internal" href="memory-profiles-and-leaks.html#memory-leaks">Memory leaks</a></li>
<li class="toctree-l1"><a class="reference internal" href="memory-profiles-and-leaks.html#memory-profiles-snapshots">Memory profiles/snapshots</a></li>
<li class="toctree-l1"><a class="reference internal" href="native-node-modules.html">native-node-modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="pr-previews.html">pr-previews</a></li>
<li class="toctree-l1"><a class="reference internal" href="pr-previews.html#faqs">FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="review.html">review</a></li>
<li class="toctree-l1"><a class="reference internal" href="review.html#code-review">Code Review</a></li>
<li class="toctree-l1"><a class="reference internal" href="review.html#code-quality">Code Quality</a></li>
<li class="toctree-l1"><a class="reference internal" href="review.html#design-and-product-review">Design and Product Review</a></li>
<li class="toctree-l1"><a class="reference internal" href="skinning%20thoughts.html">iiitemskinning thoughts</a></li>
<li class="toctree-l1"><a class="reference internal" href="theming.html">theming</a></li>
<li class="toctree-l1"><a class="reference internal" href="translating-dev.html">translating-dev</a></li>
<li class="toctree-l1"><a class="reference internal" href="translating-dev.html#requirements">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="translating-dev.html#translating-strings-vs-marking-strings-for-translation">Translating strings vs. marking strings for translation</a></li>
<li class="toctree-l1"><a class="reference internal" href="translating-dev.html#adding-new-strings">Adding new strings</a></li>
<li class="toctree-l1"><a class="reference internal" href="translating-dev.html#editing-existing-strings">Editing existing strings</a></li>
<li class="toctree-l1"><a class="reference internal" href="translating-dev.html#adding-variables-inside-a-string">Adding variables inside a string.</a></li>
<li class="toctree-l1"><a class="reference internal" href="translating-dev.html#things-to-know-style-guides">Things to know/Style Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="translating.html">translating</a></li>
<li class="toctree-l1"><a class="reference internal" href="translating.html#requirements">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="translating.html#step-0-join-element-translations-matrix-org">Step 0: Join #element-translations:matrix.org</a></li>
<li class="toctree-l1"><a class="reference internal" href="translating.html#step-1-preparing-your-weblate-profile">Step 1: Preparing your Weblate Profile</a></li>
<li class="toctree-l1"><a class="reference internal" href="translating.html#how-to-check-if-your-language-already-is-being-translated">How to check if your language already is being translated</a></li>
<li class="toctree-l1"><a class="reference internal" href="translating.html#step-2a-helping-on-existing-languages">Step 2a: Helping on existing languages.</a></li>
<li class="toctree-l1"><a class="reference internal" href="translating.html#step-2b-adding-a-new-language">Step 2b: Adding a new language</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Element -  WebApp</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>jitsi-dev</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/jitsi-dev.rst.txt" rel="nofollow"> </a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="jitsi-dev">
<h1>jitsi-dev<a class="headerlink" href="#jitsi-dev" title="Permalink to this headline">¶</a></h1>
<div class="section" id="jitsi-wrapper-developer-docs">
<h2>Jitsi wrapper developer docs<a class="headerlink" href="#jitsi-wrapper-developer-docs" title="Permalink to this headline">¶</a></h2>
<p><em>If you’re looking for information on how to set up Jitsi in your Element, see
`jitsi.md &lt;./jitsi.md&gt;`_ instead.</em></p>
<p>These docs are for developers wondering how the different conference buttons work
within Element. If you’re not a developer, you’re probably looking for <a class="reference external" href="./jitsi.md">jitsi.md</a>.</p>
</div>
</div>
<div class="section" id="brief-introduction-to-widgets">
<h1>Brief introduction to widgets<a class="headerlink" href="#brief-introduction-to-widgets" title="Permalink to this headline">¶</a></h1>
<p>Widgets are embedded web applications in a room, controlled through state events, and
have a <code class="docutils literal notranslate"><span class="pre">url</span></code> property. They are largely specified by <a class="reference external" href="https://github.com/matrix-org/matrix-doc/issues/1236">MSC1236</a>
and have extensions proposed under <a class="reference external" href="https://github.com/matrix-org/matrix-doc/issues/1286">MSC1286</a>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">url</span></code> is typically something we shove into an iframe with sandboxing (see <code class="docutils literal notranslate"><span class="pre">AppTile</span></code>
in the react-sdk), though for some widgets special integration can be done. v2 widgets
have a <code class="docutils literal notranslate"><span class="pre">data</span></code> object which helps achieve that special integration, though v1 widgets
are best iframed and left alone.</p>
<p>Widgets have a <code class="docutils literal notranslate"><span class="pre">postMessage</span></code> API they can use to interact with Element, which also allows
Element to interact with them. Typically this is most used by the sticker picker (an
account-level widget), though widgets like the Jitsi widget will request permissions to
get ‘stuck’ into the room list during a conference.</p>
<p>Widgets can be added with the <code class="docutils literal notranslate"><span class="pre">/addwidget</span> <span class="pre">&lt;url&gt;</span></code> command.</p>
</div>
<div class="section" id="brief-introduction-to-integration-managers">
<h1>Brief introduction to integration managers<a class="headerlink" href="#brief-introduction-to-integration-managers" title="Permalink to this headline">¶</a></h1>
<p>Integration managers (like Scalar and Dimension) are accessible via the 4 squares in
the top right of the room and provide a simple UI over top of bridges, bots, and other
stuff to plug into a room. They are a separate service to Element and are thus iframed
in a dialog as well. They also have a <code class="docutils literal notranslate"><span class="pre">postMessage</span></code> API they can use to interact with
the client to create things like widgets, give permissions to bridges, and generally
set everything up for the integration the user is working with.</p>
<p>Integration managers do not currently have a spec associated with them, though efforts
are underway in <a class="reference external" href="https://github.com/matrix-org/matrix-doc/issues/1286">MSC1286</a>.</p>
</div>
<div class="section" id="widgets-configured-by-integration-managers">
<h1>Widgets configured by integration managers<a class="headerlink" href="#widgets-configured-by-integration-managers" title="Permalink to this headline">¶</a></h1>
<p>Integration managers will often “wrap” a widget by using a widget <code class="docutils literal notranslate"><span class="pre">url</span></code> which points
to the integration manager instead of to where the user requested the widget be. For
example, a custom widget added in an integration manager for <a class="reference external" href="https://matrix.org">https://matrix.org</a> will
end up creating a widget with a URL like <code class="docutils literal notranslate"><span class="pre">https://integrations.example.org?widgetUrl=https%3A%2F%2Fmatrix.org</span></code>.</p>
<p>The integration manager’s wrapper will typically have another iframe to isolate the
widget from the client by yet another layer. The wrapper often provides other functionality
which might not be available on the embedded site, such as a fullscreen button or the
communication layer with the client (all widgets <em>should</em> be talking to the client
over <code class="docutils literal notranslate"><span class="pre">postMessage</span></code>, even if they aren’t going to be using the widget APIs).</p>
<p>Widgets added with the <code class="docutils literal notranslate"><span class="pre">/addwidget</span></code> command will <em>not</em> be wrapped as they are not going
through an integration manager. The widgets themselves <em>should</em> also work outside of
Element. Widgets currently have a “pop out” button which opens them in a new tab and
therefore have no connection back to Riot.</p>
</div>
<div class="section" id="jitsi-widgets-from-integration-managers">
<h1>Jitsi widgets from integration managers<a class="headerlink" href="#jitsi-widgets-from-integration-managers" title="Permalink to this headline">¶</a></h1>
<p>Integration managers will create an entire widget event and send it over <code class="docutils literal notranslate"><span class="pre">postMessage</span></code>
for the client to add to the room. This means that the integration manager gets to
decide the conference domain, conference name, and other aspects of the widget. As
a result, users can end up with a Jitsi widget that does not use the same conference
server they specified in their config.json - this is expected.</p>
<p>Some integration managers allow the user to change the conference name while others
will generate one for the user.</p>
</div>
<div class="section" id="jitsi-widgets-generated-by-element-itself">
<h1>Jitsi widgets generated by Element itself<a class="headerlink" href="#jitsi-widgets-generated-by-element-itself" title="Permalink to this headline">¶</a></h1>
<p>When the user clicks on the call buttons by the composer, the integration manager is
not involved in the slightest. Instead, Element itself generates a widget event, this time
using the config.json parameters, and publishes that to the room. If there’s only two
people in the room, a plain WebRTC call is made instead of using a widget at all - these
are defined in the Matrix specification.</p>
<p>The Jitsi widget created by Element uses a local <code class="docutils literal notranslate"><span class="pre">jitsi.html</span></code> wrapper (or one hosted by
<code class="docutils literal notranslate"><span class="pre">https://app.element.io</span></code> for desktop users or those on non-https domains) as the widget
<code class="docutils literal notranslate"><span class="pre">url</span></code>. The wrapper has some basic functionality for talking to Element to ensure the
required <code class="docutils literal notranslate"><span class="pre">postMessage</span></code> calls are fulfilled.</p>
<p><strong>Note</strong>: Per <a class="reference external" href="./jitsi.md">jitsi.md</a> the <code class="docutils literal notranslate"><span class="pre">preferredDomain</span></code> can also come from the server’s
client .well-known data.</p>
</div>
<div class="section" id="the-jitsi-wrapper-in-element">
<h1>The Jitsi wrapper in Element<a class="headerlink" href="#the-jitsi-wrapper-in-element" title="Permalink to this headline">¶</a></h1>
<p>Whenever Element sees a Jitsi widget, it ditches the <code class="docutils literal notranslate"><span class="pre">url</span></code> and instead replaces it with
its local wrapper, much like what it would do when creating a widget. However, instead
of using one from <a class="reference external" href="https://app.element.io">app.element.io</a>, it will use one local to the client instead.</p>
<p>The wrapper is used to provide a consistent experience to users, as well as being faster
and less risky to load. The local wrapper URL is populated with the conference information
from the original widget (which could be a v1 or v2 widget) so the user joins the right
call.</p>
<p>Critically, when the widget URL is reconstructed it does <em>not</em> take into account the
config.json’s <code class="docutils literal notranslate"><span class="pre">preferredDomain</span></code> for Jitsi. If it did this, users would end up on different
conference servers and therefore different calls entirely.</p>
<p><strong>Note</strong>: Per <a class="reference external" href="./jitsi.md">jitsi.md</a> the <code class="docutils literal notranslate"><span class="pre">preferredDomain</span></code> can also come from the server’s
client .well-known data.</p>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="jitsi.html" class="btn btn-neutral float-right" title="jitsi" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="feature-flags.html" class="btn btn-neutral float-left" title="feature-flags" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo" style="opacity:0.4;">
    <p>
        &#169; Copyleft <b style="font-color:darkgrey!important;font-weight:lighter;font-size:90%;font-style:italic;"><strong>2021 DATRO</strong> Consortium</b> | <a href="https://gui.8cc.online" target="_popup">gui.8cc.online</a>  .

    </p>
  </div>
    
    
    
    <div style="opacity:0.3;font-size:76%;">Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a></div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>
